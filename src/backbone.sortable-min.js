var SortableItemView=Backbone.View.extend({tagName:"li",attributes:{draggable:true},events:{dragstart:"start",dragenter:"enter",dragleave:"leave",dragend:"leave",dragover:"over",drop:"drop"},initialize:function(A){_.extend(this,A)},render:function(){this.$el.html(_.template(this.template,this.model.toJSON()));return this},start:function(){this.parent.draggedModel=this.model},enter:function(){this.$el.addClass(this.overClass)},leave:function(){this.$el.removeClass(this.overClass)},over:function(A){A.preventDefault()},drop:function(){this.leave();var A=this.parent.model;A.models.splice(A.indexOf(this.parent.draggedModel),1);A.models.splice(this.$el.index(),0,this.parent.draggedModel);_.forEach(A.models,function(C,B){C.set(this.orderField,B+1,{silent:true})},this);A.trigger("change")}});var SortableView=Backbone.View.extend({tagName:"ul",orderField:"order",overClass:"over",itemTemplate:"",initialize:function(A){_.extend(this,A);this.model.on("change",this.render,this)},render:function(){this.$el.empty();this.model.sort();_.forEach(this.model.models,this.renderItem,this);return this},renderItem:function(A){this.$el.append(new SortableItemView({model:A,orderField:this.orderField,template:this.itemTemplate,overClass:this.overClass,parent:this}).render().el)}});